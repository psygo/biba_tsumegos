
\documentclass[12pt]{book}

% A4
\usepackage[
  paperheight   = 297mm, 
  paperwidth    = 210mm,
  bindingoffset = 10mm,
  left          = 7.5mm,
  right         = 12.5mm,
  top           = 20mm,
  bottom        = 15mm,
  footskip      = 5mm,
]{geometry}

\def\repoPath{/Users/phili/Code/Go/tsumego_workbooks/src}
\usepackage{\repoPath/config}

\pgfkeys{%
  /phili/tdgChapterGenerator/.cd, 
    chapter name/.store in = \tdgChapterName,
    chapter name           = Chapter,
    path/.store in         = \tdgChapterPath,
    path                   = sgf,
    max problem/.store in  = \tdgProblemMax,
    max problem            = 1,
}

\newcommand\tdgChapterGenerator[1][]{%
  \pgfkeys{/phili/tdgChapterGenerator/.cd, #1}%
  \chapter{\tdgChapterName}
  \clearpage
  \foreach \i in {1,...,\tdgProblemMax}{
    \problemDiagram[%
      path                      = \tdgChapterPath/\i.sgf,
      problem size              = 8.5,
      problem text              = ,
      caption horizontal margin = -0.4cm,
      horizontal clip start     = 8,
      horizontal clip end       = 19,
      vertical clip start       = 9,
      vertical clip end         = 19,
    ]
  }
  \hspace*{-\fill}
}

\newcommand\coverRuler{
  \rule{0.97\textwidth}{1.6pt}\vspace*{-\baselineskip}\vspace*{2pt}
  \rule{0.97\textwidth}{0.4pt}
}

\begin{document}
  \blankpage
  \begin{titlepage}
    \centering
    
    \scshape % Small Caps

    \vspace*{-1.6cm}
    
    %---------------------------------------------------------
    % Título
    
    \coverRuler
    
    \vspace{1\baselineskip}
    
    \fontsize{50pt}{50pt}\selectfont{Técnicas de Go} \\
    % \huge{Técnicas de Go}\\
    \vspace*{0.3cm}
    \fontsize{40pt}{40pt}\selectfont{Volume \rom{1}} \\
    % \large{Volume \rom{1}}\\
    \vspace*{0.2375cm}
    \Large{Liberdades e Vida ou Morte}

    \vspace{0.275\baselineskip}
    
    \coverRuler

    %---------------------------------------------------------

    \vspace*{-0.42cm}

    %---------------------------------------------------------
    % Imagem
    
    \begin{figure}[h]
      \centering
      \hbox{
        % Inside the book, this changes due to the margins
        \hspace{2.75cm}
        % \hspace{0.6cm}
        \begin{goban}[board dimension       = 11,
                      board size            = 9,
                      scale                 = 1,
                      outline line width    = 0.45mm,
                      horizontal clip start = 1,
                      horizontal clip end   = 9,
                      vertical clip start   = 1,
                      vertical clip end     = 9]
          \parseSgfFile{\repoPath/sgf/tecnicas_de_go/capa_9x9_atravessar.sgf}
        \end{goban}
      }
    \end{figure}

    %---------------------------------------------------------
    
    \vspace*{-0.4cm}

    %---------------------------------------------------------
    % Autor

    \Large{Philippe Fanaro}

    %---------------------------------------------------------
  \end{titlepage}
  
  \blankpage
  
  \frontmatter

  \tableofcontents

  \mainmatter

  \tdgChapterGenerator[%
    chapter name = Captura Direta,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/captura},
    max problem  = 10,
  ]

  \tdgChapterGenerator[%
    chapter name = Resgate,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/resgate},
    max problem  = 10,
  ]
\end{document}